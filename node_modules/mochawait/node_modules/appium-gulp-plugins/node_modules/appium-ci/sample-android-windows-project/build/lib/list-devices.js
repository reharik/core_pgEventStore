'use strict';

var _slicedToArray = require('babel-runtime/helpers/sliced-to-array')['default'];

var _Object$defineProperty = require('babel-runtime/core-js/object/define-property')['default'];

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

_Object$defineProperty(exports, '__esModule', {
  value: true
});

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _utils = require('./utils');

var _utils2 = _interopRequireDefault(_utils);

function listDevices() {
  var _ref, _ref2, stdout, lines;

  return _regeneratorRuntime.async(function listDevices$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        context$1$0.next = 2;
        return _regeneratorRuntime.awrap(_utils2['default'].exec('adb devices'));

      case 2:
        _ref = context$1$0.sent;
        _ref2 = _slicedToArray(_ref, 1);
        stdout = _ref2[0];
        lines = stdout.match(/^.*([\n\r]+|$)/gm);
        return context$1$0.abrupt('return', (0, _lodash2['default'])(lines).filter(function (l) {
          return !(l.trim().length === 0 || l.match(/List of devices attached/));
        }).map(function (l) {
          return l.trim().split('\t')[0];
        }).value());

      case 7:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
}

exports['default'] = listDevices;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9saXN0LWRldmljZXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7c0JBQWMsUUFBUTs7OztxQkFDSixTQUFTOzs7O0FBRTNCLFNBQWUsV0FBVzttQkFDbkIsTUFBTSxFQUNQLEtBQUs7Ozs7Ozt5Q0FEWSxtQkFBTSxJQUFJLENBQUMsYUFBYSxDQUFDOzs7OztBQUF6QyxjQUFNO0FBQ1AsYUFBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsa0JBQWtCLENBQUM7NENBQ3JDLHlCQUFFLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFDLENBQUMsRUFBSztBQUM1QixpQkFBTyxFQUFFLEFBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLE1BQU0sS0FBSyxDQUFDLElBQzdCLENBQUMsQ0FBQyxLQUFLLENBQUMsMEJBQTBCLENBQUMsQ0FBQSxBQUFDLENBQUM7U0FDeEMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFDLENBQUMsRUFBSztBQUNaLGlCQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDaEMsQ0FBQyxDQUNELEtBQUssRUFBRTs7Ozs7OztDQUNUOztxQkFFYyxXQUFXIiwiZmlsZSI6ImxpYi9saXN0LWRldmljZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHV0aWxzIGZyb20gJy4vdXRpbHMnO1xuXG5hc3luYyBmdW5jdGlvbiBsaXN0RGV2aWNlcygpIHtcbiAgbGV0IFtzdGRvdXRdID0gYXdhaXQgdXRpbHMuZXhlYygnYWRiIGRldmljZXMnKTtcbiAgdmFyIGxpbmVzID0gc3Rkb3V0Lm1hdGNoKC9eLiooW1xcblxccl0rfCQpL2dtKTtcbiAgcmV0dXJuIF8obGluZXMpLmZpbHRlcigobCkgPT4ge1xuICAgIHJldHVybiAhKChsLnRyaW0oKS5sZW5ndGggPT09IDApIHx8XG4gICAgICBsLm1hdGNoKC9MaXN0IG9mIGRldmljZXMgYXR0YWNoZWQvKSk7XG4gIH0pLm1hcCgobCkgPT4ge1xuICAgIHJldHVybiBsLnRyaW0oKS5zcGxpdCgnXFx0JylbMF07XG4gIH0pXG4gIC52YWx1ZSgpO1xufVxuXG5leHBvcnQgZGVmYXVsdCBsaXN0RGV2aWNlcztcbiJdfQ==